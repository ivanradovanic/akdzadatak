package proba;

import java.sql.*;
import java.util.ArrayList;
import java.util.List;

public class zadatak {
	static final String JDBC_DRIVER = "org.h2.Driver";   
	   static final String DB_URL = "jdbc:h2:~/test";
	   static final String fileName = "AKDTEST20191004001";
	   
	   //  Database credentials 
	   static final String USER = "admin"; 
	   static final String PASS = "pass";
	
	public static void main(String[] args) { 
		Connection conn = null; 
	    Statement task = null;
	    
	    List<Podaci> sviPodaci = new ArrayList<Podaci>();
	    sviPodaci = new Podaci().loadFromCSV(fileName);
	    
	    
	    try {
	    	Class.forName(JDBC_DRIVER);
	    	
	    	conn = DriverManager.getConnection(DB_URL,USER,PASS);
	    	
	    	task = conn.createStatement(); 
	         String sql =  "CREATE TABLE   PODACI " + 
	            "(id INTEGER not NULL, " + 
	            " ime VARCHAR(30), " +  
	            " prezime VARCHAR(30), " +  
	            " spol VARCHAR(1), " + 
	            " datumRodenja VARCHAR(10), " +
	            " mjesto VARCHAR(20), " + 
	            " drzava VARCHAR(20), " +
	            " PRIMARY KEY ( id ))";  
	         task.executeUpdate(sql);
	         
	         task.close(); 
	         conn.close(); 
	    } catch(SQLException se) { 
	         //Handle errors for JDBC 
	         se.printStackTrace(); 
	      } catch(Exception e) { 
	         //Handle errors for Class.forName 
	         e.printStackTrace(); 
	      } finally { 
	         //finally block used to close resources 
	         try{ 
	            if(task!=null) task.close(); 
	         } catch(SQLException se2) { 
	         } // nothing we can do 
	         try { 
	            if(conn!=null) conn.close(); 
	         } catch(SQLException se){ 
	            se.printStackTrace(); 
	         } //end finally try 
	      } //end try 
		
		
		
		//System.out.println("Uspio");
	}
}
